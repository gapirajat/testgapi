<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Upload Files</title>
    <script type="text/javascript" src="code.js"></script>
    <script>
      function configureDropDownLists(ddl1,ddl2) {
    var PHY = ['PHYUnit1', 'PHYUnit2', 'PHYUnit3','PHYUnit4','PHYUnit5','PHYUnit6'];
    var MC = ['MCUnit1', 'MCUnit2', 'MCUnit3','MCUnit4','MCUnit5','MCUnit6'];
    var EM = ['EMUnit1', 'EMUnit2', 'EMUnit3','EMUnit4'];
    var CPPS = ['CPPSUnit1', 'CPPSUnit2', 'CPPSUnit3','CPPSUnit4'];
    var EG = ['EGUnit1', 'EGUnit2', 'EGUnit3','EGUnit4'];

    switch (ddl1.value) {
        case 'PHY':
            ddl2.options.length = 0;
            for (i = 0; i < PHY.length; i++) {
                createOption(ddl2, PHY[i], PHY[i]);
            }
            break;
        case 'MC':
            ddl2.options.length = 0; 
        for (i = 0; i < MC.length; i++) {
            createOption(ddl2, MC[i], MC[i]);
            }
            break;
        case 'EM':
            ddl2.options.length = 0;
            for (i = 0; i < EM.length; i++) {
                createOption(ddl2, EM[i], EM[i]);
            }
            break;
        case 'CPPS':
            ddl2.options.length = 0;
            for (i = 0; i < CPPS.length; i++) {
                createOption(ddl2, CPPS[i], CPPS[i]);
            }
            break;
        case 'EG':
            ddl2.options.length = 0;
            for (i = 0; i < EG.length; i++) {
                createOption(ddl2, EG[i], EG[i]);
            }
            break;
            default:
                ddl2.options.length = 0;
            break;
    }

}

    function createOption(ddl, text, value) {
        var opt = document.createElement('option');
        opt.value = value;
        opt.text = text;
        ddl.options.add(opt);
    }
    </script>
  </head>
  <body>
    <h1 id ="demo">File Uploader</h1>
    <select id="ddl" onchange="configureDropDownLists(this,document.getElementById('ddl2'))">
<option value="PHY">PHY</option>
<option value="MC">MC</option>
<option value="EM">EM</option>
<option value="EG">EG</option>
<option value="CPPS">CPPS</option>
</select>

<select id="ddl2">
</select>
    <form>
        <input type="file" name="myFile" mulitple>
        <br>
        <br>
        <input type="button" id="submitBtn" value="Upload Files">
        <label id="resp"></label>
    </form>
   <script>
      //google.script.run.getElementById('submitBtn').relator();
      document.getElementById('submitBtn').addEventListener('click',
        function(e){google.script.run.relator()
          google.script.run.withSuccessHandler(onSuccess).uploadFiles(this.parentNode)
        })
        function onSuccess(data){
          document.getElementById('resp').innerHTML = "File Uploaded to the path " +data;
          alert("Thank you your file has been uploaded to " + document.getElementById('ddl2').value );

        }
       
    </script>
  </body>
</html>
           google.script.run.withSuccessHandler(onSuccess).uploadFiles(this.parentNode)function(e){
  
        }
